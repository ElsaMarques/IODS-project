---
title: "Chapter5"
author: "Elsa Marques"
date: "11/29/2017"
output: html_document
---

# Dimensionality reduction techniques

*This chapter will teach you how to reduce a huge amount of variables (data dimensions) to a smaller and more relevant variables in order to make it easier to visualize and compare different data populations. The key method to reduce the multidimensional data is the principal component analysis (PCA). The multiple correspondence analysis (MCA) and other correspondece analysis (CA) are also covered in this chapter.*

# *About this week working data set "Human"*

  > The 'human' dataset originates from the United Nations Development Programme. See their [data page](http://hdr.undp.org/en/content/human-development-index-hdi) for more information. For a nice overview see also the calculating the human development indices [pdf](http://hdr.undp.org/sites/default/files/hdr2015_technical_notes.pdf).
This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

## 1. **Load the ‘human’ data into R.**

```{r, echo=FALSE}
#Load the data set used in the data wrangling section(from your local drive)
read.csv("human_.csv")
```


### 1.1 **Explore the structure and the dimensions of the data and describe the dataset briefly.**

```{r, echo=FALSE}
library(dplyr)
str(human_)
dim(human_)
```

 - The brief overview on this data shows that the data "human_" created during the data wrangling exercise comprises 155 observations spread into 8 variables. 
 - These observations are selected from a bigger data set of observations included to calculate the human development index (HDI).
 - Selected factors are:
    - Edu2.FM  = % of secondary school age population (Female and Male); 
    - Labo.FM  = The amount of people (Female and Male) that are active in laboral life; 
    - Edu.Exp = Education experiences;
    - GNI = Gross national income per capita; 
    - Life.Exp = life expectancy upon birth;
    - Mat.Mor = maternal mortality rate (deaths
per100,000 live births);
    - Ado.Birth = adolescent birth rate 
    - Parli.F = % of seats taken by female in the parliament
 
 describe the dataset briefly, assuming the reader has no previous knowledge of it (this is now close to the reality, since you have named the variables yourself). (0-1 point)

## 2. **Show a graphical overview of the data and show summaries of the variables in the data.** 

```{r, echo=FALSE}
library(GGally)
library(corrplot)

# visualize the 'human_' variables
ggpairs(human_)

summarize(human_)
```

```{r, echo=FALSE}

# compute the correlation matrix and visualize it with corrplot
human_ %>% cor()
```

- Describe and interpret the outputs, commenting on the distributions of the variables and the relationships between them. (0-2 points)

## 3. **Perform principal component analysis (PCA) on the not standardized human data.**
```{r}
# modified human is available

# perform principal component analysis (with the SVD method)
pca_human <- prcomp(human_)

# draw a biplot of the principal component representation and the original variables
biplot(pca_human, choices = 1:2, cex = c(0.2,1), col = c("grey40", "deeppink2"))
```


### 3.1 **Show the variability captured by the principal components.** 

### 3.2 **Draw a biplot displaying the observations by the first two principal components (PC1 coordinate in x-axis, PC2 coordinate in y-axis), along with arrows representing the original variables.** 

```{r}
# pca_human, dplyr are available

# create and print out a summary of pca_human
s <- summary(pca_human)
s

# rounded percetanges of variance captured by each PC
pca_pr <- round(100*s$importance[2, ], digits = 1)

# print out the percentages of variance
pca_pr

# create object pc_lab to be used as axis labels
pc_lab <- paste0(names(pca_pr), " (", pca_pr, "%)")

# draw a biplot
biplot(pca_human, cex = c(0.8, 1), col = c("grey40", "deeppink2"), xlab = NA, ylab = NA)
```

(0-2 points)

## 4. **Standardize the variables in the human data and repeat the above analysis.** 
```{r}
# modified human is available

# standardize the variables
human_std <- scale(human)

# print out summaries of the standardized variables
summary(human_std)

# perform principal component analysis (with the SVD method)
pca_human <- prcomp(human_std)

# draw a biplot of the principal component representation and the original variables
biplot(pca_human, choices = 1:2, cex = c(0.2,1), col = c("grey40", "deeppink2"))
```

Interpret the results of both analysis (with and without standardizing). Are the results different? Why or why not? Include captions in you plots where you describe the results by using not just your variable names, but the actual phenomenons they relate to. (0-4 points)

## 5. **Personal interpretations of the first two principal component dimensions based on the biplot drawn after PCA on the standardized human data.** 

(0-2 points)

## 6. **Load the tea dataset from the package Factominer.**

```{r}
# Load the tea dataset and packages FactoMineR
library(FactoMineR)
data("tea")
```


### 6.1 **Explore the data briefly: look at the structure and the dimensions of the data and visualize it.** 

```{r}
# column names to keep in the dataset
keep_columns <- c("Tea", "How", "how", "sugar", "where", "lunch")

# select the 'keep_columns' to create a new dataset
tea_time <- select(tea, one_of(keep_columns))

# look at the summaries and structure of the data
summary(tea_time)
str(tea_time)

# visualize the dataset
gather(tea_time) %>% ggplot(aes(value)) + facet_wrap("key", scales = "free") + geom_bar() + theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 8)) 
```


### 6.2 **Then do Multiple Correspondence Analysis on the tea data (or to a certain columns of the data, it’s up to you).** 

```{r}
# multiple correspondence analysis
mca <- MCA(tea_time, graph = FALSE)

# summary of the model
summary(mca)


```


Interpret the results of the MCA and 

### 6.3 **draw at least the variable biplot of the analysis. You can also explore other plotting options for MCA.** 

```{r}


# visualize MCA
plot(mca, invisible=c("none"), habillage = "quali")
```


Comment on the output of the plots. (0-4 points)
